import{j as e,p as d,k as _,o as l,L as m}from"./index-6pVjbv8z.js";async function g(){try{const t=sessionStorage.getItem("pkce_state"),s=sessionStorage.getItem("pkce_code_verifier"),o=new URLSearchParams(window.location.search);if(o.get("state")!==t)throw Error("State check failed");const c=o.get("code"),n=new URL(e.oauthAccessToken),a={Accept:"application/json, text/plain, */*","Content-Type":"application/json",Origin:e.redirectUri},i={grant_type:e.grantType,client_id:e.clientId,redirect_uri:e.redirectUri,code_verifier:s,code:c},p=JSON.stringify(i),r=await(await fetch(n,{headers:a,body:p,method:"post",mode:"cors"})).json();r.access_token!=null?sessionStorage.setItem("access_token",r.access_token):(sessionStorage.removeItem("access_token"),sessionStorage.removeItem("pkce_code_verifier"),sessionStorage.removeItem("pkce_state")),window.location.replace(e.homeUri)}catch(t){console.error("Error during OAuth2 flow:",t)}}const S={__name:"CallbackPage",setup(t){return d(()=>g()),(s,o)=>(l(),_(m))}};export{S as default};
